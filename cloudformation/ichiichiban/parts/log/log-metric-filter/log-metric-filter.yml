---
AWSTemplateFormatVersion: 2010-09-09
Description:
  Setting up log metric filter
Parameters:
  LogGroupName:
    Type       : String
    Description: Log Group Name
    MinLength  : 1
  MetricNamespace:
    Type       : String
    Description: Metric Namespace
    MinLength  : 1
Resources:
  # ---------------------------------------------------------------#
  # Create Log Metric Filter
  # ---------------------------------------------------------------#
  # https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-logs-metricfilter.html
  LogMetricFilterError:
    Type      : AWS::Logs::MetricFilter
    Properties:
      FilterPattern        : "?ERROR ?Error ?error"
      LogGroupName         : !Ref LogGroupName
      MetricTransformations:
        - MetricName     : Error
          MetricNamespace: !Ref MetricNamespace
          MetricValue    : 1
  LogMetricFilterWarn:
    Type      : AWS::Logs::MetricFilter
    Properties:
      FilterPattern        : "?WARN ?Warn ?warn"
      LogGroupName         : !Ref LogGroupName
      MetricTransformations:
        - MetricName     : Warn
          MetricNamespace: !Ref MetricNamespace
          MetricValue    : 1
  LogMetricFilterFatal:
    Type      : AWS::Logs::MetricFilter
    Properties:
      FilterPattern        : "?FATAL ?Fatal ?fatal"
      LogGroupName         : !Ref LogGroupName
      MetricTransformations:
        - MetricName     : Fatal
          MetricNamespace: !Ref MetricNamespace
          MetricValue    : 1